# GEMINI.md - Project-Specific Guidelines for Agent

This document provides essential information and best practices for the Gemini CLI agent to effectively understand, navigate, and contribute to the `modresources` project.

## 1. Project Overview

The `modresources` project is a pnpm monorepo designed to manage assets, tools, and data related to Minecraft mod development. It comprises:
*   A React-based frontend for UI interactions.
*   Node.js/TypeScript scripts for automation and data generation.
*   A Python CLI tool (`moddy`) for specific development tasks.
*   Shared Gradle configurations for Minecraft mod builds.

## 2. Key Technologies

*   **Frontend**: React, TypeScript, Vite, Tailwind CSS, DaisyUI
*   **Backend (Local Dev Server)**: Node.js, Express, TypeScript
*   **Scripts**: Node.js, TypeScript, `tsx` runner
*   **Python CLI**: Python 3
*   **Package Manager**: pnpm (monorepo setup)
*   **Version Control**: Git

## 3. Project Conventions & Structure

*   **Monorepo Root**: The root directory contains shared configurations (e.g., `pnpm-workspace.yaml`, root `package.json`, `tsconfig.json`, `eslint.config.js`).
*   **Packages Directory (`packages/`)**:
    *   `packages/frontend`: Contains the React UI application, its source code (`src/`), public assets (`public/`), and frontend-specific configuration files (`vite.config.ts`, `tsconfig.json`, `postcss.config.js`, `tailwind.config.js`, `vitest.config.ts`).
    *   `packages/scripts`: Contains Node.js/TypeScript utility scripts.
*   **`moddy` Directory**: This is a standalone Python project. Its source is in `moddy/src`, and generated artifacts are in `moddy/registry`.
*   **Gradle Configurations (`gradle/`)**: These are external configurations referenced by other projects and should generally be treated as read-only.
*   **Data Files**: `mods.json`, `mods.v2.json`, and files within the `update/` directory contain core mod metadata.
*   **Event Reports**: Generated event reports are placed in `tmp-event-summaries/` (for limited runs) or `docs/` (for full runs).

## 4. Common Commands

The following commands are frequently used and should be preferred for common tasks:

*   **Install Dependencies**: `pnpm install`
*   **Start Development Servers**: `pnpm dev:concurrent` (starts frontend and local API server)
*   **Build Project**: `pnpm build` (builds the frontend for production)
*   **Run Tests**: `pnpm test` (runs Vitest tests for frontend)
*   **Run Linters**: `pnpm lint` (runs ESLint across the monorepo)
*   **Format Code**: `pnpm format` (formats code using Prettier)

### Package-Specific Script Execution

To run scripts defined within a specific package's `package.json`, use `pnpm --filter <package-name> <script-name>`. For example:
*   `pnpm --filter @modresources/scripts generate:modrinth`
*   `pnpm --filter @modresources/frontend dev`

## 5. Important Considerations for the Agent

*   **Path Resolution**: Be mindful of relative paths when modifying or creating files, especially within `packages/`. Always consider the current working directory of the executed command or the context of the file being edited. Use `path.join` and `path.resolve` with `process.cwd()` or `fileURLToPath(import.meta.url)` as appropriate for robust path construction.
*   **TypeScript Configuration**: The TypeScript setup is distributed. The root `tsconfig.json` references package-specific `tsconfig.json` files. When adding new TypeScript files or packages, ensure they are correctly included in the relevant `tsconfig.json`.
*   **Modrinth Client Generation**: The Modrinth API client is generated by `packages/scripts/generateModrinthClient.ts`. If there are issues with Modrinth types, regenerating this client is often the first step.
*   **Interactive Python Scripts**: The `moddy` Python scripts (e.g., `moddy.py setup`) may require interactive input. The agent cannot provide this. Inform the user if manual intervention is needed.
*   **Event Report Limits**: When generating event reports, prefer using the `-- --limit <n>` argument (e.g., `pnpm --filter @modresources/scripts generate:fabric-event-report -- --limit 5`) to limit processing for faster iteration during development/testing.
*   **`server.ts` Location**: `server.ts` is now located in `packages/frontend/` as it's tightly coupled with the UI.

## 6. Multi-line Commit Messages

When creating multi-line commit messages, directly embedding newlines in the `run_shell_command`'s `command` parameter can lead to parsing issues. To ensure robust multi-line commit messages that do not expose temporary files in the remote repository, follow this process:

1.  **Write the multi-line commit message content to a temporary file** within the project directory (e.g., `.gemini_commit_message.txt`). This file should be created using the `write_file` tool.
2.  **Add the temporary commit message file's name to `.gitignore`**. This prevents it from being tracked by Git and appearing in commits.
3.  **Stage the `.gitignore` file** if it was modified in the previous step.
4.  **Execute the `git commit -F <path_to_temp_file>` command**. This tells Git to read the commit message from the specified temporary file.
5.  **Delete the temporary file** using `rm` after the commit is successful.

# Documentation Analysis and Correction Task: Order 66

If the user requests **Order 66** you must do the following:

Please analyze all documentation files in this codebase and identify/fix any errors. Focus on:

## üîç **Analysis Scope**

### **Code Example Accuracy (TypeScript/JavaScript)**
- Verify all code examples within `README.md`, `docs/*.md`, and comments in `packages/scripts/**/*.ts` and `packages/frontend/**/*.ts` compile and run correctly.
- Check method signatures, parameter names, and return types against actual TypeScript/JavaScript source.
- Validate class names, module imports, and namespaces.
- Ensure API usage matches current implementations in `packages/frontend/src/api.ts`, `packages/frontend/src/services/`, and generated Modrinth client (`packages/frontend/src/modrinth/`).

### **Python Script Accuracy (`moddy`)**
- Verify code examples and instructions related to `moddy` in `moddy/README.md` and `moddy/AGENTS.md` are accurate and executable.
- Check command-line arguments, expected inputs, and outputs for `moddy` scripts.
- Validate any Python code snippets for syntax and correctness.

### **Cross-Reference Validation**
- Compare documentation against actual source code across all relevant files (`.ts`, `.tsx`, `.py`, `.json`).
- Verify all referenced files, classes, methods, and data structures exist and are correctly named.
- Check that examples use correct public APIs (e.g., from `packages/frontend/src/api.ts`, not internal implementation details).
- Validate that deprecated APIs or patterns are not used in documentation.

### **Consistency Checks**
- Ensure consistent naming conventions throughout all documentation and code examples.
- Verify code style matches project standards (e.g., ESLint rules, Prettier formatting).
- Check for consistent parameter naming and usage across examples.
- Validate that similar examples use identical patterns and best practices for the `modresources` project.

### **Completeness Review**
- Identify missing documentation for new features or recently added scripts/API endpoints.
- Check that all public APIs and common usage patterns are documented.
- Verify examples cover typical use cases for both frontend interactions and script execution.
- Ensure any migration guides or setup instructions reflect the current state of the monorepo.

## üéØ **Specific Issues to Look For**

### **Common API/Script Mistakes**
- Incorrect `pnpm` commands or `--filter` usage.
- Outdated import paths for modules within the monorepo.
- Wrong method signatures or parameter types in TypeScript/JavaScript examples.
- Incorrect command-line arguments for `packages/scripts` or `moddy` commands.
- References to non-existent files, functions, or API endpoints.

### **Monorepo-Specific Issues**
- Instructions that assume a non-monorepo structure (e.g., incorrect relative paths).
- Missing or incorrect `tsconfig.json` configurations for specific packages.
- Inaccurate guidance on running scripts from the monorepo root vs. within packages.

### **Code Example Problems**
- Examples that won't compile or execute due to syntax errors, missing imports, or incorrect API usage.
- Incomplete code blocks that are not self-contained or illustrative.
- Inconsistent variable naming or coding style within examples.
- Missing error handling where appropriate in examples.

## üîß **Fix Process**

1.  **Read all documentation files**: Start by reviewing `README.md`, `docs/*.md`, `moddy/README.md`, `moddy/AGENTS.md`, and relevant code comments.
2.  **Cross-reference with source code**: Systematically verify every API call, script command, and data structure mentioned in the documentation against the actual implementation in `.ts`, `.tsx`, `.py`, and `.json` files.
3.  **Test execution**: Where possible, attempt to run code examples (e.g., `pnpm` scripts, `moddy` commands) to confirm their correctness.
4.  **Update incorrect references**: Correct any outdated or inaccurate references to APIs, file paths, or command syntax.
5.  **Add missing context**: Ensure all examples and instructions are clear, self-contained, and provide sufficient context for the user.
6.  **Ensure consistency**: Standardize naming, formatting, and coding style across all documentation.
7.  **Verify monorepo compatibility**: Confirm that all instructions and examples are compatible with the pnpm monorepo structure.

## üìã **Deliverables**

### **Summary Report**
- List of files analyzed.
- Total number of issues found.
- Category breakdown (e.g., TypeScript API errors, Python script errors, pathing issues, consistency).
- Severity assessment (e.g., critical compilation errors vs. minor style issues).

### **Detailed Issue List**
For each issue found:
- File name and line number.
- Description of the problem.
- Current (incorrect) code/text.
- Corrected code/text.
- Explanation of why the change was needed.

### **Applied Fixes**
- Make all necessary corrections directly in the codebase.
- Ensure all examples compile and run correctly and reflect the current state of the `modresources` project.
- Update any outdated information or add missing documentation for new features.

## ‚ö†Ô∏è **Important Guidelines**

-   **Don't invent APIs/Commands**: Only document what actually exists and is implemented in the codebase.
-   **Test Examples**: Ensure all code blocks and command-line examples are functional and accurate.
-   **Maintain Abstraction**: Document public APIs and intended usage patterns, not internal implementation details. 
-   **Preserve Intent**: Fix errors while maintaining the original meaning and purpose of the documentation.
-   **Be Comprehensive**: Do not skip files; verify all relevant documentation.
-   **Moddy Changes**: All changes to Moddy must be documented in `moddy/UNRELEASED.md`.

## üéØ **Success Criteria**

-   All code examples (TypeScript, JavaScript, Python) compile and run successfully.
-   All API references and command instructions point to existing, current methods/scripts.
-   Documentation accurately reflects the current state of the `modresources` codebase.
-   Examples follow project conventions and best practices for a pnpm monorepo.
-   No references to deprecated or non-existent APIs/commands.
-   All instructions are clear, unambiguous, and easy to follow for a developer working in this monorepo.
